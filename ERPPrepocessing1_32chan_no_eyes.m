%Downsample to 500 Hz
EEG = pop_resample(EEG, 500);

%Add channel location
EEG=pop_chanedit(EEG,'lookup', '/Users/abbiepopa/Documents/MATLAB/eeglab14_1_0b/plugins/dipfit2.3/standard_BESA/standard-10-5-cap385.elp');
%EEG=pop_chanedit(EEG,'lookup', '/Users/minderplab/Desktop/EEGlab/eeglab13_5_4b/plugins/dipfit2.3/standard_BESA/standard-10-5-cap385.elp');
%EEG=pop_chanedit(EEG,'lookup', 'C:\Users\MIND\Documents\MATLAB\eeglab13_4_4b\plugins\dipfit2.3\standard_BESA\standard-10-5-cap385.elp');
%EEG=pop_chanedit(EEG,'lookup', '/Users/MIND/Documents/MATLAB/eeglab13_4_4b/plugins/dipfit2.3/standard_BESA/standard-10-5-cap385.elp');
%EEG=pop_chanedit(EEG,'lookup', '/Users/cabil/Documents/MATLAB/eeglab13_4_4b/plugins/dipfit2.3/standard_BESA/standard-10-5-cap385.elp');

%Filter, High pass 0.1, Low pass 30
EEG  = pop_basicfilter( EEG,  1:32 , 'Boundary', 'boundary', 'Cutoff', [ 0.1 30], 'Design', 'butter', 'Filter', 'bandpass', 'Order',  2,...
 'RemoveDC', 'on' ); 

%Notch Filter
EEG  = pop_basicfilter( EEG,  1:32 , 'Boundary', 'boundary', 'Cutoff',  60, 'Design', 'notch', 'Filter', 'PMnotch', 'Order',  180, 'RemoveDC',...
 'on' );

EEG = pop_eegchanoperator( EEG, {  'nch1 = ch1 - ( (ch10 + ch21)/2 ) Label Fp1',  'nch2 = ch2 - ( (ch10 + ch21)/2 ) Label Fz',...
  'nch3 = ch3 - ( (ch10 + ch21)/2 ) Label F3',  'nch4 = ch4 - ( (ch10 + ch21)/2 ) Label F7',  'nch5 = ch5 - ( (ch10 + ch21)/2 ) Label FT9',...
  'nch6 = ch6 - ( (ch10 + ch21)/2 ) Label FC5',  'nch7 = ch7 - ( (ch10 + ch21)/2 ) Label FC1',  'nch8 = ch8 - ( (ch10 + ch21)/2 ) Label C3',...
  'nch9 = ch9 - ( (ch10 + ch21)/2 ) Label T7',  'nch10 = ch10 - ( (ch10 + ch21)/2 ) Label TP9',  'nch11 = ch11 - ( (ch10 + ch21)/2 ) Label CP5',...
  'nch12 = ch12 - ( (ch10 + ch21)/2 ) Label CP1',  'nch13 = ch13 - ( (ch10 + ch21)/2 ) Label Pz',  'nch14 = ch14 - ( (ch10 + ch21)/2 ) Label P3',...
  'nch15 = ch15 - ( (ch10 + ch21)/2 ) Label P7',  'nch16 = ch16 - ( (ch10 + ch21)/2 ) Label O1',  'nch17 = ch17 - ( (ch10 + ch21)/2 ) Label Oz',...
  'nch18 = ch18 - ( (ch10 + ch21)/2 ) Label O2',  'nch19 = ch19 - ( (ch10 + ch21)/2 ) Label P4',  'nch20 = ch20 - ( (ch10 + ch21)/2 ) Label P8',...
  'nch21 = ch21 - ( (ch10 + ch21)/2 ) Label TP10',  'nch22 = ch22 - ( (ch10 + ch21)/2 ) Label CP6',  'nch23 = ch23 - ( (ch10 + ch21)/2 ) Label CP2',...
  'nch24 = ch24 - ( (ch10 + ch21)/2 ) Label Cz',  'nch25 = ch25 - ( (ch10 + ch21)/2 ) Label C4',  'nch26 = ch26 - ( (ch10 + ch21)/2 ) Label T8',...
  'nch27 = ch27 - ( (ch10 + ch21)/2 ) Label FT10',  'nch28 = ch28 - ( (ch10 + ch21)/2 ) Label FC6',  'nch29 = ch29 - ( (ch10 + ch21)/2 ) Label FC2',...
  'nch30 = ch30 - ( (ch10 + ch21)/2 ) Label F4',  'nch31 = ch31 - ( (ch10 + ch21)/2 ) Label F8',...
  'nch32 = ch32 - ( (ch10 + ch21)/2 ) Label Fp2'} , 'ErrorMsg', 'popup', 'Warning',...
 'on' );

%Add channel location do on both versions
EEG=pop_chanedit(EEG,'lookup', '/Users/abbiepopa/Documents/MATLAB/eeglab14_1_0b/plugins/dipfit2.3/standard_BESA/standard-10-5-cap385.elp');
%EEG=pop_chanedit(EEG,'lookup', '/Users/minderplab/Desktop/EEGlab/eeglab13_5_4b/plugins/dipfit2.3/standard_BESA/standard-10-5-cap385.elp');
%EEG=pop_chanedit(EEG,'lookup', 'C:\Users\MIND\Documents\MATLAB\eeglab13_4_4b\plugins\dipfit2.3\standard_BESA\standard-10-5-cap385.elp');
%EEG=pop_chanedit(EEG,'lookup', '/Users/MIND/Documents/MATLAB/eeglab13_4_4b/plugins/dipfit2.3/standard_BESA/standard-10-5-cap385.elp');
%EEG=pop_chanedit(EEG,'lookup', '/Users/cabil/Documents/MATLAB/eeglab13_4_4b/plugins/dipfit2.3/standard_BESA/standard-10-5-cap385.elp');

eeglab redraw